<!DOCTYPE html>
<html>
  <head>
    <title>Graffiti Grabber</title>
    <%= csrf_meta_tags %>

    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>

    <link href="css/vitality-blue.css" rel="stylesheet" type="text/css">

  </head>

  <body class="modern">
  <header>
    
    

    <nav class="navbar navbar-default">
      <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">GG</a>

        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav">
            
            <% if current_user %>
              <li><%= link_to 'Log Out', '/logout', method: :delete %></li>
            <% else %>
              <li><a href="/signup">Sign Up</a></li>
              <li><a href="/login">Log In</a></li>
            <% end %> 


            <% if current_user %>
              <li><%= link_to 'Submit A Graffiti Clean Up Request', '/images/new' %></li>
            <% else %>
              <li><h4>Sign up to submit graffiti cleanup requests!</h4></li>
            <% end %> 
            
            
          </ul>

          <%= form_tag '/images', method: :get, class: "navbar-form navbar-right"  do %>
            <div class="form-group">
              <%= text_field_tag :search_term, nil, placeholder: "Search Gangs/Status", class: "form-control" %>
            </div>
            <%= submit_tag 'Search', class: "btn btn-default" %>
          <% end %>


          <ul class="nav navbar-nav navbar-right">
            
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Filter by Created Date: <input type="text" name="daterange" value="10/01/2016 - 10/31/2016" /></a>
              
            </li>
          </ul>
        </div><!-- /.navbar-collapse -->
      </div><!-- /.container-fluid -->
    </nav>

        <style>
          html, body {
            height: 100%;
            margin: 0;
            padding: 0;
          }
          #map {
            height: 90%;
          }
        </style>
    <!--   </head>
      <body> -->
        <div id="map"></div>    
        <script>

          function initMap() {
            var merchmart = {lat: 41.8885, lng: -87.6354};
            var map = new google.maps.Map(document.getElementById('map'), {
              zoom: 12,
              center: merchmart,
              streetViewControl: false ,
               styles: [
                           {elementType: 'geometry', stylers: [{color: '#242f3e'}]},
                           {elementType: 'labels.text.stroke', stylers: [{color: '#242f3e'}]},
                           {elementType: 'labels.text.fill', stylers: [{color: '#746855'}]},
                           {
                             featureType: 'administrative.locality',
                             elementType: 'labels.text.fill',
                             stylers: [{color: '#d59563'}]
                           },
                           {
                             featureType: 'poi',
                             elementType: 'labels.text.fill',
                             stylers: [{color: '#d59563'}]
                           },
                           {
                             featureType: 'poi.park',
                             elementType: 'geometry',
                             stylers: [{color: '#263c3f'}]
                           },
                           {
                             featureType: 'poi.park',
                             elementType: 'labels.text.fill',
                             stylers: [{color: '#6b9a76'}]
                           },
                           {
                             featureType: 'road',
                             elementType: 'geometry',
                             stylers: [{color: '#38414e'}]
                           },
                           {
                             featureType: 'road',
                             elementType: 'geometry.stroke',
                             stylers: [{color: '#212a37'}]
                           },
                           {
                             featureType: 'road',
                             elementType: 'labels.text.fill',
                             stylers: [{color: '#9ca5b3'}]
                           },
                           {
                             featureType: 'road.highway',
                             elementType: 'geometry',
                             stylers: [{color: '#746855'}]
                           },
                           {
                             featureType: 'road.highway',
                             elementType: 'geometry.stroke',
                             stylers: [{color: '#1f2835'}]
                           },
                           {
                             featureType: 'road.highway',
                             elementType: 'labels.text.fill',
                             stylers: [{color: '#f3d19c'}]
                           },
                           {
                             featureType: 'transit',
                             elementType: 'geometry',
                             stylers: [{color: '#2f3948'}]
                           },
                           {
                             featureType: 'transit.station',
                             elementType: 'labels.text.fill',
                             stylers: [{color: '#d59563'}]
                           },
                           {
                             featureType: 'water',
                             elementType: 'geometry',
                             stylers: [{color: '#17263c'}]
                           },
                           {
                             featureType: 'water',
                             elementType: 'labels.text.fill',
                             stylers: [{color: '#515c6d'}]
                           },
                           {
                             featureType: 'water',
                             elementType: 'labels.text.stroke',
                             stylers: [{color: '#17263c'}]
                           }
                         ]        
            });
            map.setMapTypeId(google.maps.MapTypeId.ROADMAP);



            $.get('/', function(data) {
              for (i = 0; i < data.length; i++) {
                data_hash = {};
                data_hash.lat = parseFloat(data[i].lat);
                data_hash.lng = parseFloat(data[i].lng);
                            
                var marker = new google.maps.Marker({
                  position: data_hash,
                map: map
              });

                marker.content = '<p>ID: <a href="/images/' + data[i].id + '">' + data[i].id + '</a></p>'+
                                      '<p>Gang: ' + data[i].gang + '</p>'+
                                      '<p>Surface Location: ' + data[i].surface_location + '</p>'+
                                      '<p>Location Type: ' + data[i].type_of_surface + '</p>'+
                                      '<p>Status: ' + data[i].status  + '</p>';

                var infoWindow = new google.maps.InfoWindow();
                google.maps.event.addListener(marker, 'click', function () {
                                                infoWindow.setContent(this.content);
                                                infoWindow.open(this.getMap(), this);
                                            });

                
              }
            });
          }
         
        </script>

  </header>
 
    <%= yield %>
  </body>
</html>


